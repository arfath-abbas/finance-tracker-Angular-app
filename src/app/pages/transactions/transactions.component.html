<div class="container">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2>Transactions</h2>
        <button class="btn btn-success" (click)="openAddDialog()">+ Add Transaction</button>
    </div>

    <p-progressSpinner *ngIf="loading" styleClass="block mx-auto my-5" strokeWidth="4"></p-progressSpinner>

    <p-card *ngIf="!loading" class="shadow-sm">
        <p-table class="modern-table" [value]="transactions" [paginator]="true" [rows]="10"
            [rowsPerPageOptions]="[5, 10, 20]" [responsiveLayout]="'scroll'" [showCurrentPageReport]="true"
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            [style]="{ 'min-width': '100%' }">
            <ng-template pTemplate="header">
                <tr>
                    <th>Date</th>
                    <th>Description</th>
                    <th>Category</th>
                    <th>Amount</th>
                    <th>Type</th>
                    <th>Actions</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-tx>
                <tr>
                    <td>{{ tx.transactionDate }}</td>
                    <td>{{ tx.description }}</td>
                    <td><span class="badge bg-info">{{ tx.category }}</span></td>
                    <td>{{ tx.amount }}</td>
                    <td><span class="badge bg-warning">{{ tx.type }}</span></td>
                    <td class="action-icons">
                        <i class="pi pi-pencil icon-edit" (click)="editTransaction(tx)" title="Edit"></i>
                        <i class="pi pi-trash icon-delete" (click)="deleteTransaction(tx.id)" title="Delete"></i>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </p-card>

    <p-card>
        <p-dialog [(visible)]="showAddDialog" header="Add/Edit Transaction" [modal]="true" [style]="{ width: '400px' }">
            <form [formGroup]="transactionForm" (ngSubmit)="saveTransaction()">
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" class="form-control" formControlName="transactionDate" />
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <input type="text" class="form-control" formControlName="description" />
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <input type="text" class="form-control" formControlName="category" />
                </div>
                <div class="form-group">
                    <label>Amount</label>
                    <input type="number" class="form-control" formControlName="amount" />
                </div>
                <div class="form-group">
                    <label>Type</label>
                    <select class="form-control" formControlName="type">
                        <option value="EXPENSE">Expense</option>
                        <option value="INCOME">Income</option>
                    </select>
                </div>
                <div class="text-right mt-3">
                    <button type="button" class="btn btn-secondary mr-2" (click)="showAddDialog = false">Cancel</button>
                    <button type="submit" class="btn btn-success">Save</button>
                </div>
            </form>
        </p-dialog>
    </p-card>
    <p-toast></p-toast>
    <p-confirmDialog></p-confirmDialog>
</div>